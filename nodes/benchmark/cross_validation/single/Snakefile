import os

TOKEN = config["token"]

if type(config["csv_in"]) == list:
    CSV_DIR = os.path.dirname(config["csv_in"][0]) + "/"
    CSVS_IN = config["csv_in"]
else:
    CSV_DIR = os.path.dirname(config["csv_in"]) + "/"
    CSVS_IN = [config["csv_in"]]

rule all:
    input:
         expand(config["cv_dir_out"] + f"y_true_cv_{{name}}.csv",
                name=[os.path.basename(p).replace(".csv", "") for p in CSVS_IN]),
         expand(config["cv_dir_out"] + f"y_pred_cv_{{name}}.csv",
                name=[os.path.basename(p).replace(".csv", "") for p in CSVS_IN]),
         expand(config["cv_dir_out"] + f"y_prob_cv_{{name}}.csv",
                name=[os.path.basename(p).replace(".csv", "") for p in CSVS_IN])

rule train:
    input:
         f"{CSV_DIR}{{name}}.csv"
    output:
         config["cv_dir_out"] + f"y_true_cv_{{name}}.csv",
         config["cv_dir_out"] + f"y_pred_cv_{{name}}.csv",
         config["cv_dir_out"] + f"y_prob_cv_{{name}}.csv"
    script:
         "../scripts/cv.py"

 # for i in range(50):
 #     y_pred = df.iloc[i, :190].dropna()
 #     y_true = df.iloc[i, 190:].dropna()
 #     print((len(y_pred), len(y_true)))
 #     print(matthews_corrcoef(y_true, y_pred))